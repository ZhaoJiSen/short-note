---
title: 方法
createTime: 2025/09/26 17:43:18
permalink: /rust/p21lsigg/
---

[+self]: 这个 self 可以是 `&self`(当前结构体实例的引用)、`&mut self`(当前结构体实例的可变引用)、`self`(当前结构体实例的所有权)

方法即定义在结构体中的函数，它们的第一个参数总是 `self`[+self] 用于表示调用该方法的结构体实例

## 定义方法

方法需要放在 `impl` 块中实现，在使用时通过 `instance.method()` 即可调用

:::rust-repl title="定义方法"
```rust
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
}

fn main() {
    let rect = Rectangle { width: 30, height: 50 };
    println!("area = {}", rect.area());
}
```
:::

> [!IMPORTANT]
> - `&self` 其实是 `self: &Self` 的缩写，而 `Self` 表示的是当前 `impl` 块的类型的别名
> - 有 `self` 参数的才是“方法”；没有 `self` 的是关联函数，二者调用形式不同

## 关联函数

[+命名空间]: “命名空间”指路径的分层组织

所有在 `impl` 中定义的不带 `self` 参数的函数被称为 ==关联函数==，因为它们与 `impl` 后面命名的类型相关。它们常被用作返回新实例的构造函数（通常命名为 `new`），调用时用 `TypeName::new()` 这样的 `::` 命名空间[+命名空间]语法

```rust
impl Rectangle {
  fn new(width: u32, height: u32) -> Self {
    Self {
        width,
        height,
    }
  }
}
```
