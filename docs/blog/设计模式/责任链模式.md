---
title: 责任链模式
tags:
  - 设计模式
createTime: 2026/02/27 15:50:16
permalink: /blog/3whi1x9n/
---

责任链模式把请求沿处理链依次传递，直到有节点处理或链尾结束。

## 解决的问题

多个处理者都可能处理同一请求时，硬编码 `if/else` 会导致强耦合且扩展困难。

## 结构组成

:::table full-width

| 角色 | 作用 |
| --- | --- |
| Handler | 抽象处理者，持有下一个节点 |
| ConcreteHandler | 具体处理逻辑 |
| Client | 发起请求 |

:::

## 示例

```ts
interface LeaveRequest {
  user: string
  days: number
}

abstract class Handler {
  private next: Handler | null = null

  setNext(handler: Handler) {
    this.next = handler
    return handler
  }

  protected pass(req: LeaveRequest) {
    if (this.next)
      return this.next.handle(req)
    return `无人可审批：${req.user} ${req.days} 天`
  }

  abstract handle(req: LeaveRequest): string
}

class Leader extends Handler {
  handle(req: LeaveRequest) {
    if (req.days <= 2)
      return `Leader 审批通过：${req.user}`
    return this.pass(req)
  }
}

class Manager extends Handler {
  handle(req: LeaveRequest) {
    if (req.days <= 5)
      return `Manager 审批通过：${req.user}`
    return this.pass(req)
  }
}

class Director extends Handler {
  handle(req: LeaveRequest) {
    if (req.days <= 10)
      return `Director 审批通过：${req.user}`
    return this.pass(req)
  }
}

const leader = new Leader()
const manager = new Manager()
const director = new Director()

leader.setNext(manager).setNext(director)

console.log(leader.handle({ user: 'Alice', days: 4 }))
```

## 适用场景

- 审批流、风控校验链
- 中间件管道（如 Koa）
- 请求过滤器链路

