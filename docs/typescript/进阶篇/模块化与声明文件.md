---
title: 模块化与声明文件
createTime: 2026/02/09 21:40:00
permalink: /typescript/modules/
---

## 什么是模块

在 TypeScript 中，只要文件包含顶层 `import` 或 `export`，该文件就会被视为模块。

```ts
export {}
```

上面这种写法常用于“把脚本文件显式变为模块”，避免全局命名污染。

## ES Module 基础

```ts
// add.ts
export const add = (a: number, b: number) => a + b

// index.ts
import { add } from './add'
console.log(add(1, 2))
```

## 类型导入与类型导出

```ts
import type { User } from './types'
export type { User }
```

`type` 导入在编译后会被擦除，适合纯类型依赖。

## CommonJS 互操作

当你使用 CommonJS 包时，通常有三种方式：

```ts
import * as fs from 'node:fs'
import { readFileSync } from 'node:fs'
// 在配置允许时：
import fsDefault from 'node:fs'
```

常见相关配置：
- `esModuleInterop`
- `allowSyntheticDefaultImports`

## 模块解析策略

`tsconfig.json` 常见设置：

```json
{
  "compilerOptions": {
    "module": "ESNext",
    "moduleResolution": "Bundler"
  }
}
```

- 前端构建工具（Vite/Nuxt）常用：`Bundler`
- Node 原生 ESM 项目常用：`NodeNext`

## 声明文件 `.d.ts`

声明文件只描述类型，不产生运行时代码。

### 声明第三方模块

```ts
declare module 'legacy-lib' {
  export function format(input: string): string
}
```

### 声明资源模块

```ts
declare module '*.svg' {
  const url: string
  export default url
}
```

## 命名空间（namespace）说明

`namespace` 是早期组织代码方案。现代项目中，优先使用 ESM。

```ts
export namespace Price {
  export const format = (n: number) => `￥${n}`
}
```

> [!TIP]
> 新项目一般不建议再用 `namespace` 作为主要模块组织方式。
